{"version":3,"sources":["../../../src/controllers/help/getsymbolData.js"],"names":["request","require","module","exports","getTransactionPairListData","ex","cb","exType","huobiApiData","data","binanceApiData","okexApiData","gateApiData","then"],"mappings":";;AAEA;;;;;;AADA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;;AAEA;AACAC,OAAOC,OAAP,CAAeC,0BAAf,GAA0C,UAASC,EAAT,EAAYC,EAAZ,EAAe;;AAGrD;AACA,aAASC,MAAT,CAAgBF,EAAhB,EAAmB,CAyClB;;AAvCG;;AAEA;;AAEA;;AAEA;;;AAGA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAIR;AACI;AACA,aAASG,YAAT,CAAsBC,IAAtB,EAA2B,CAoC1B;;AAlCD;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAGJ;AACK;AACD,aAASC,cAAT,CAAwBD,IAAxB,EAA6B,CAiC5B;;AA/BG;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAGR;AACI;AACA,aAASE,WAAT,CAAqBF,IAArB,EAA0B,CA+BzB;;AA7BG;;AAEA;;AAEA;;AAEA;;;AAGA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;;AAGR;AACI;AACA,aAASG,WAAT,CAAqBH,IAArB,EAA0B,CA8BzB;;AA5BG;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAGR;AACI;AACAF,WAAOF,EAAP,EACCQ,IADD,CACM,UAASJ,IAAT,EAAc;;AAElB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEE,KA9BJ;AAkCH,CAlOD","file":"getsymbolData.js","sourcesContent":["\nvar request = require('request');\nimport chDate from '../../lib/date';\n//获取币种交易对列表数据>>并插入数据库>>实时更新\nmodule.exports.getTransactionPairListData=function(ex,cb){\n\n   \n    //判断传入参数 - - 所属交易所类型\n    function exType(ex){\n\n        // console.log('判断传入参数 - - 所属交易所类型',ex);\n\n        // var p = new Promise(function(resolve, reject){\n\n        //         if (ex === 'huobi') { \n\n        //             var url = \"https://api.huobi.br.com/market/tickers\"\n                    \n                    \n        //             resolve({'ex':ex,'url':url});\n\n        //         }else if (ex === 'binance') {\n\n        //             var url = \"https://api.binance.com/api/v1/ticker/24hr\"\n        //             //var url = \"https://api.binance.com/api/v1/time\"\n        //             resolve({'ex':ex,'url':url});\n\n        //         }else if (ex === 'okex') { \n\n        //             var url = \"https://www.okex.me/api/spot/v3/instruments/ticker\"\n\n        //             resolve({'ex':ex,'url':url});\n\n        //         }else if (ex ==='gate') { \n\n        //             var url = \"https://data.gateio.co/api2/1/marketlist\" \n\n        //             resolve({'ex':ex,'url':url});\n\n        //         }else{\n\n        //             console.log(\"传入的ex参数错误\");\n        //             reject(\"传入的ex参数错误\");\n        //         }\n\n        //     });\n\n        //  return p;\n\n    } \n \n/******************************************************/\n    //调用huobi-api接口获取实时行情数据\n    function huobiApiData(data){\n\n    //     //console.log(\"huobi api .... ok\");\n\n    //     request(data.url, function (error, response, body) {\n\n    //         if (!error && response.statusCode == 200) {\n                \n    //             try{\n\n    //                 var body = JSON.parse(body);//将json字符串转换成json对象\n    //                 //console.log(\"body..... \",body );\n\n    //                 var cbData = body.data;\n\n    //                 //console.log(\"cbData..... \",cbData );\n\n    //                 cbData.push({\"symbol\":\"huobi_ex1\"});\n\n    //                 return cb(cbData);\n\n    //             }catch(e){\n\n    //                 //console.log(\"eee........\",e,body);\n    //                 return cb({'res_code':'01030005'},{'describe':'res json error- -Too Many Requests'});\n\n    //             }\n    //         }else{\n\n    //             console.log(\"error\");\n\n    //             return ;\n    //         }\n\n    // })\n\n    } \n/******************************************************/\n     //调用binance-api接口获取实时行情数据\n    function binanceApiData(data){\n\n        // let nowTime = new Date();\n\n        // let nowTimeStamp = new Date().getTime();\n\n        // console.log(\"start....binance_get_data>>>>me-TimeStamp\",nowTimeStamp);\n\n        // const rp = require('request-promise');\n\n        // const requestOptions = {\n        //   method: 'GET',\n        //   uri: data.url,\n        //   qs: {\n           \n        //   },\n        //   headers: {\n        //     'X-MBX-APIKEY': 'YcK7OsEZkD8ycowOtEXOXHeYvzCWsFxxaV6kuD972HcwzhdEG8qz2SdGeG121SmA',//hailian159@gmail.com-hk小号\n        //     'timestamp':nowTimeStamp//当前时间戳\n\n        //   },\n        //   json: true,\n        //   gzip: true\n        // };\n        // console.log('API --->>>>>>>>>:',data.url);\n        // rp(requestOptions).then(response => {\n        //   console.log('API call binancebinancebinance----->>>>>>>>>okokok:',nowTimeStamp, response);\n        // }).catch((err) => {\n        //   console.log('API call error:', err);\n        // });\n\n        // return;\n        \n    }\n/******************************************************/\n    //调用okex-api接口获取实时行情数据\n    function okexApiData(data){\n        \n        // //console.log(\"okexApiData api .... ok\",data.url);\n\n        // request(data.url, function (error, response, body) {\n\n        //     if (!error) {\n                \n        //         try{\n\n\n        //             var cbData = JSON.parse(body);//将json字符串转换成json对象\n        //             //console.log(\"body....\",body[0]);\n        //             return cb(cbData);\n\n        //         }catch(e){\n\n        //             //console.log(\"eee........\",e,body);\n        //             return cb({'res_code':'01030005'},{'describe':'res json error- -Too Many Requests'});\n\n        //         }\n        //     }else{\n\n        //         console.log(\"error\");\n\n        //         return ;\n        //     }\n\n        // })\n\n        // return;\n    }\n\n/******************************************************/\n    //调用gate-api接口获取实时行情数据\n    function gateApiData(data){\n\n        // //console.log(\"gateApiData api .... ok\",data.url);\n\n        // request(data.url, function (error, response, body) {\n\n        //     if (!error) {\n                \n        //         try{\n        //             var cbData = JSON.parse(body);//将json字符串转换成json对象\n        //             //console.log(\"body....\",body[0]);\n        //             return cb(cbData);\n\n        //         }catch(e){\n\n        //             console.log(\"eee........\",e,body);\n        //             return cb({'res_code':'01030005'},{'describe':'res json error- -Too Many Requests'});\n\n        //         }\n        //     }else{\n\n        //         console.log(\"error\");\n\n        //         return ;\n        //     }\n\n        // })\n\n        // return;\n\n    }\n/******************************************************/\n    //开始执行>>>\n    exType(ex)\n    .then(function(data){\n\n      //   if (data.ex === \"huobi\") {//- - huobi\n\n      //       //console.log(\"hi huobi\");\n\n      //       return huobiApiData(data);\n\n      //   }else if(data.ex === \"okex\"){//- - okex\n\n      //       //console.log(\"hi okex\");\n\n      //       return okexApiData(data);\n\n      //   }else if(data.ex === \"gate\"){//- - gate\n\n      //       //console.log(\"hi gate\");\n\n      //       return gateApiData(data);\n\n      //   }else if(data.ex === \"binance\"){// - -binance\n\n      //       return binanceApiData(data);\n      //   }else{\n\n      //       console.log(\"传入参数错误......\");\n\n      //    }\n\n       });\n\n       \n      \n}\n\n"]}